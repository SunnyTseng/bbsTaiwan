---
title: "Black Bulbul case study"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(bbsTaiwan)
library(tidyverse)
library(terra)
```

```{r import_data}

bird_data <- bbs_fetch(target_species = "紅嘴黑鵯")
```

```{r}

bbs_plotmap(target_species = "紅嘴黑鵯")

elevation <- bbs_sites() |>
  vect(geom=c("decimalLongitude", "decimalLatitude"), crs = "epsg:4326") %>%
  extract(x = tw_elev %>% rast(crs = "epsg:4326", type = "xyz"), bind = TRUE) %>%
  rename(elevation = ncol(.)) %>%
  as_tibble()

bird_data %>%
  select(year, month, locationID, individualCount) %>%
  filter(individualCount != 0) %>%
  left_join(elevation, by = join_by(locationID)) %>%
  ggplot() +
    geom_boxplot(aes(x = month %>% as_factor(), y = elevation))
  
  
```
